addPolygons(data = maricopa_cd)
mb_access_token(token = "pk.eyJ1Ijoid2VzdGVybGV5eSIsImEiOiJja2JrOWZ5NGYwa3d2MnlwZ3RwMW1xdjUzIn0.l2xVZDgKTA0VKYYbQrUhrg", overwrite = T, install = T)
mb_access_token(token = "pk.eyJ1Ijoid2VzdGVybGV5eSIsImEiOiJja2JrOWZ5NGYwa3d2MnlwZ3RwMW1xdjUzIn0.l2xVZDgKTA0VKYYbQrUhrg", overwrite = TRUE, install = TRUE)
list_tokens("westerleyy")
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox")
maricopa_map %>%
addPolygons(data = maricopa_cd)
colnames(maricopa_cd)[1] <- "CD"
phoenix <- mb_geocode("Phoenix")
maricopa_map %>%
addPolygons(data = maricopa_cd) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 10)
maricopa_map %>%
addPolygons(data = maricopa_cd) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8)
maricopa_map %>%
addPolygons(data = maricopa_cd) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 9)
maricopa_map %>%
addPolygons(data = maricopa_cd) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
mediumr:::medium_create_post_from_Rmd()
View(maricopa_2016_presidential_congress)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(leaflet)
library(sf)
library(RColorBrewer)
library(ggplot2)
library(DT)
library(mapboxapi)
# reading in data
## Maricopa Co. data dump
maricopa_2020_11132020 <- read_tsv("Maricopa_2020_Provisional_111320.txt")
maricopa_2016 <- read_tsv("Maricopa_2016.txt")
## Maricopa Co. Voter Registration by Party
maricopa_2016_party_voter_registration <- read_csv("MaricopaCounty_2016_VoterRegPartyBreakdown.csv")
maricopa_2020_party_voter_registration <- read_csv("MaricopaCounty_2020_VoterRegPartyBreakdown.csv")
## Shapefiles
maricopa_precincts_2018 <- read_sf("./Shapefiles/VotingPrecincts/VotingPrecincts.shp")
maricopa_precincts_2018 <- st_transform(maricopa_precincts_2018, 4326)
maricopa_precincts_2016 <- read_sf("./Shapefiles/VotingPrecincts/HistoricalVotingPrecincts_12thru16.shp")
maricopa_precincts_2016 <- st_transform(maricopa_precincts_2016, 4326)
maricopa_cd <- read_sf("./Shapefiles/CD/MaricopaCD.shp")
maricopa_cd <- st_transform(maricopa_cd, 4326)
colnames(maricopa_cd)[1] <- "CD"
## joining elections data
maricopa_2016_rep <- maricopa_2016_presidential_congress %>%
filter(party = "REP")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(leaflet)
library(sf)
library(RColorBrewer)
library(ggplot2)
library(DT)
library(mapboxapi)
# reading in data
## Maricopa Co. data dump
maricopa_2020_11132020 <- read_tsv("Maricopa_2020_Provisional_111320.txt")
maricopa_2016 <- read_tsv("Maricopa_2016.txt")
## Maricopa Co. Voter Registration by Party
maricopa_2016_party_voter_registration <- read_csv("MaricopaCounty_2016_VoterRegPartyBreakdown.csv")
maricopa_2020_party_voter_registration <- read_csv("MaricopaCounty_2020_VoterRegPartyBreakdown.csv")
## Shapefiles
maricopa_precincts_2018 <- read_sf("./Shapefiles/VotingPrecincts/VotingPrecincts.shp")
maricopa_precincts_2018 <- st_transform(maricopa_precincts_2018, 4326)
maricopa_precincts_2016 <- read_sf("./Shapefiles/VotingPrecincts/HistoricalVotingPrecincts_12thru16.shp")
maricopa_precincts_2016 <- st_transform(maricopa_precincts_2016, 4326)
maricopa_cd <- read_sf("./Shapefiles/CD/MaricopaCD.shp")
maricopa_cd <- st_transform(maricopa_cd, 4326)
colnames(maricopa_cd)[1] <- "CD"
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(leaflet)
library(sf)
library(RColorBrewer)
library(ggplot2)
library(DT)
library(mapboxapi)
# reading in data
## Maricopa Co. data dump
maricopa_2020_11132020 <- read_tsv("Maricopa_2020_Provisional_111320.txt")
maricopa_2016 <- read_tsv("Maricopa_2016.txt")
## Maricopa Co. Voter Registration by Party
maricopa_2016_party_voter_registration <- read_csv("MaricopaCounty_2016_VoterRegPartyBreakdown.csv")
maricopa_2020_party_voter_registration <- read_csv("MaricopaCounty_2020_VoterRegPartyBreakdown.csv")
## Shapefiles
maricopa_precincts_2018 <- read_sf("./Shapefiles/VotingPrecincts/VotingPrecincts.shp")
maricopa_precincts_2018 <- st_transform(maricopa_precincts_2018, 4326)
maricopa_precincts_2016 <- read_sf("./Shapefiles/VotingPrecincts/HistoricalVotingPrecincts_12thru16.shp")
maricopa_precincts_2016 <- st_transform(maricopa_precincts_2016, 4326)
maricopa_cd <- read_sf("./Shapefiles/CD/MaricopaCD.shp")
maricopa_cd <- st_transform(maricopa_cd, 4326)
colnames(maricopa_cd)[1] <- "CD"
# extracting congressional candidate per precinct
congress_2020 <- function(results){
voteshare_df <- results %>%
filter(str_detect(ContestName, "^US Rep"),
CandidateAffiliation %in% c("REP", "DEM")) %>%
select(PrecinctId, PrecinctName, ContestName, CandidateName, Votes, `Votes_EARLY VOTE`, `Votes_ELECTION DAY`, Votes_PROVISIONAL, `Turnout_EARLY VOTE`, `Turnout_ELECTION DAY`, Registered, Turnout, TurnoutPerc) %>%
na.omit()
}
congress_2016 <- function(results, CONTEST_FULL_NAME){
voteshare_df <- results %>%
filter(str_detect(CONTEST_FULL_NAME, "^US Rep"),
candidate_party_id %in% c(1, 2)) %>%
select(PRECINCT_NAME, CONTEST_FULL_NAME, CANDIDATE_FULL_NAME, TOTAL, CONTEST_TOTAL) %>%
na.omit()
}
# extracting congressional race per precinct
## separate functions have to be written for 2016 and 2020 because the reporting format was different
cd_per_precinct <- function(cd_results){
cd_per_precinct <- cd_results %>%
select(PrecinctName, ContestName) %>%
unique()
cd_per_precinct <- cd_per_precinct %>%
group_by(PrecinctName) %>%
mutate(PrecinctId = substr(PrecinctName, 1, 4),
PrecinctName = substr(PrecinctName, 6, nchar(PrecinctName)),
ContestName = substr(ContestName, 16, 16))
colnames(cd_per_precinct) <- c("PrecinctName", "CD", "PrecinctId")
cd_per_precinct
}
cd_per_precinct_2016 <- function(cd_results){
cd_per_precinct <- cd_results %>%
select(PRECINCT_NAME, CONTEST_FULL_NAME) %>%
unique()
cd_per_precinct <- cd_per_precinct %>%
group_by(PRECINCT_NAME) %>%
mutate(PRECINCT_ID = substr(PRECINCT_NAME, 1,4),
PRECINCT_NAME = substr(PRECINCT_NAME, 6, nchar(PRECINCT_NAME)),
CONTEST_FULL_NAME = substr(CONTEST_FULL_NAME, 15, 15)) %>%
ungroup()
colnames(cd_per_precinct) <- c("PrecinctName", "CD", "PrecinctId")
cd_per_precinct <- cd_per_precinct[,c(3,1,2)]
cd_per_precinct
}
# extracting presidential candidate and calculating pct votes
presidential <- function(results){
voteshare_df <- results %>%
filter(ContestName == "Presidential Electors",
CandidateId %in% c(1, 2)) %>%
select(PrecinctId, PrecinctName, CandidateName, Votes, `Votes_EARLY VOTE`, `Votes_ELECTION DAY`, Votes_PROVISIONAL, `Turnout_EARLY VOTE`, `Turnout_ELECTION DAY`, Registered, Turnout, TurnoutPerc) %>%
na.omit()
voteshare_df <- voteshare_df %>%
group_by(PrecinctId) %>%
mutate(PrecinctId = substr(PrecinctName, 1, 4),
PrecinctName = substr(PrecinctName, 6, nchar(PrecinctName))) %>%
ungroup()
voteshare_df
}
presidential_2020_other_candidates <- function(results){
voteshare_df <- results %>%
filter(ContestName == "Presidential Electors",
!CandidateId %in% c(1, 2)) %>%
select(PrecinctId, PrecinctName, CandidateName, Votes, `Votes_EARLY VOTE`, `Votes_ELECTION DAY`, Votes_PROVISIONAL, `Turnout_EARLY VOTE`, `Turnout_ELECTION DAY`, Registered, Turnout, TurnoutPerc) %>%
na.omit()
voteshare_df <- voteshare_df %>%
group_by(PrecinctId) %>%
mutate(PrecinctId = substr(PrecinctName, 1, 4),
PrecinctName = substr(PrecinctName, 6, nchar(PrecinctName))) %>%
ungroup()
voteshare_df
}
presidential_2016 <- function(results){
voteshare_df <- results %>%
filter(CONTEST_FULL_NAME == "Presidential Electors",
candidate_party_id %in% c(1, 2)) %>%
select(PRECINCT_NAME, CANDIDATE_FULL_NAME, TOTAL, CONTEST_TOTAL)
voteshare_df <- voteshare_df %>%
mutate(PrecinctId = substr(PRECINCT_NAME, 1,4),
PrecinctName = substr(PRECINCT_NAME, 6, nchar(PRECINCT_NAME))) %>%
select(PrecinctId, PrecinctName, CANDIDATE_FULL_NAME, TOTAL, CONTEST_TOTAL)
voteshare_df
}
presidential_2016_other_candidates <- function(results){
voteshare_df <- results %>%
filter(CONTEST_FULL_NAME == "Presidential Electors",
!candidate_party_id %in% c(1, 2)) %>%
select(PRECINCT_NAME, CANDIDATE_FULL_NAME, TOTAL, CONTEST_TOTAL)
voteshare_df <- voteshare_df %>%
mutate(PrecinctId = substr(PRECINCT_NAME, 1,4),
PrecinctName = substr(PRECINCT_NAME, 6, nchar(PRECINCT_NAME))) %>%
select(PrecinctId, PrecinctName, CANDIDATE_FULL_NAME, TOTAL, CONTEST_TOTAL)
voteshare_df
}
candidate_voteshare <- function(results, candidate){
voteshare_df <- results %>%
filter(CandidateName == candidate) %>%
mutate(PctVotes = round(Votes/Turnout, 2),
PrecinctId = substr(PrecinctName, 1, 4))
voteshare_df
}
# latest data dump
maricopa_2020_11132020_congress <- maricopa_2020_11132020 %>%
congress_2020()
maricopa_2016_congress <- maricopa_2016 %>%
congress_2016()
cd_per_precinct_2020 <- maricopa_2020_11132020_congress %>%
cd_per_precinct()
cd_per_precinct_2016 <- maricopa_2016_congress %>%
cd_per_precinct_2016()
maricopa_2020_11132020_narrow <- maricopa_2020_11132020 %>%
presidential()
maricopa_2020_dems_111320 <- maricopa_2020_11132020_narrow %>%
candidate_voteshare(., "BIDEN / HARRIS")
maricopa_2020_reps_111320 <- maricopa_2020_11132020_narrow %>%
candidate_voteshare(., "TRUMP / PENCE")
maricopa_2016_presidential <- maricopa_2016 %>%
presidential_2016()
maricopa_2020_11132020_narrow <- inner_join(maricopa_2020_11132020_narrow, cd_per_precinct_2020)
maricopa_2016_presidential <- inner_join(maricopa_2016_presidential, cd_per_precinct_2016)
# non dem/rep
maricopa_2020_11132020_3parties <- maricopa_2020_11132020 %>%
presidential_2020_other_candidates() %>%
group_by(PrecinctId, PrecinctName) %>%
summarise(total_3p_votes = sum(Votes))
maricopa_2020_11132020_3parties <- inner_join(maricopa_2020_11132020_3parties, cd_per_precinct_2020)
maricopa_2016_3parties <- maricopa_2016 %>%
presidential_2016_other_candidates() %>%
group_by(PrecinctId, PrecinctName) %>%
summarise(total_3p_votes = sum(TOTAL))
maricopa_2016_3parties <- inner_join(maricopa_2016_3parties, cd_per_precinct_2016)
## joining elections data
maricopa_2016_rep <- maricopa_2016_presidential_congress %>%
filter(party == "REP")
maricopa_cd_2016_rep <- inner_join(maricopa_cd, maricop_2016_rep)
maricopa_cd_2016_rep <- inner_join(maricopa_cd, maricopa_2016_rep)
maricopa_2016_rep <- maricopa_2016_presidential_congress %>%
filter(party == "DEM")
maricopa_2016_dem <- maricopa_2016_presidential_congress %>%
filter(party == "DEM")
## joining elections data
maricopa_2016_rep <- maricopa_2016_presidential_congress %>%
filter(party == "REP")
View(maricopa_2020_party_voter_registration)
View(maricopa_2020_11132020_presidential_congress)
maricopa_2020_rep <- maricopa_2020_11132020_presidential_congress %>%
filter(party == "REP")
maricopa_2020_dem <- maricopa_2020_11132020_presidential_congress %>%
filter(party == "DEM")
## color bins
bins <- c(20, 30, 40, 50, 60, 70, 80)
View(maricopa_2020_dem)
View(maricopa_cd)
View(maricopa_2020_11132020_presidential_congress)
View(maricopa_2016_presidential_congress)
rep16_pal <- colorBin("Reds", domain = maricopa_2016_rep$votes_pct_2016, bins = bins)
rep20_pal <- colorBin("Reds", domain = maricopa_2020_rep$votes_pct_2020, bins = bins)
dem16_pal <- colorBin("Blues", domain = maricopa_2016_dem$votes_pct_2016, bins = bins)
dem20_pal <- colorBin("Blues", domain = maricopa_2020_dem$votes_pct_2020, bins = bins)
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District", weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Democrats", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
## geolocating phoenix
phoenix <- mb_geocode("Phoenix")
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District", weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Democrats", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
## joining elections data
maricopa_2016_rep <- maricopa_2016_presidential_congress %>%
filter(party == "REP")
maricopa_2016_dem <- maricopa_2016_presidential_congress %>%
filter(party == "DEM")
maricopa_2020_rep <- maricopa_2020_11132020_presidential_congress %>%
filter(party == "REP")
maricopa_2020_dem <- maricopa_2020_11132020_presidential_congress %>%
filter(party == "DEM")
maricopa_cd_2016_rep <- inner_join(maricopa_cd, maricopa_2016_rep)
maricopa_cd_2016_dem <- inner_join(maricopa_cd, maricopa_2016_dem)
maricopa_cd_2020_rep <- inner_join(maricopa_cd, maricopa_2020_rep)
maricopa_cd_2020_dem <- inner_join(maricopa_cd, maricopa_2020_dem)
## color bins
bins <- c(20, 30, 40, 50, 60, 70, 80)
rep16_pal <- colorBin("Reds", domain = maricopa_2016_rep$votes_pct_2016, bins = bins)
rep20_pal <- colorBin("Reds", domain = maricopa_2020_rep$votes_pct_2020, bins = bins)
dem16_pal <- colorBin("Blues", domain = maricopa_2016_dem$votes_pct_2016, bins = bins)
dem20_pal <- colorBin("Blues", domain = maricopa_2020_dem$votes_pct_2020, bins = bins)
## geolocating phoenix
phoenix <- mb_geocode("Phoenix")
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District", weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Democrats", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District", weight = 0, opacity = 0.75, color = "white") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Democrats", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
?addpolygons
?addPolygons
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District", weight = 0.5, opacity = 0.75,
color = "white", fillColor = "grey") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Democrats", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
## color bins
bins <- c(0, 20, 30, 40, 50, 60, 70, 80, 100)
bins <- c(0, 20, 30, 40, 50, 60, 70, 80, 100)
rep16_pal <- colorBin("Reds", domain = maricopa_2016_rep$votes_pct_2016, bins = bins)
rep20_pal <- colorBin("Reds", domain = maricopa_2020_rep$votes_pct_2020, bins = bins)
dem16_pal <- colorBin("Blues", domain = maricopa_2016_dem$votes_pct_2016, bins = bins)
dem20_pal <- colorBin("Blues", domain = maricopa_2020_dem$votes_pct_2020, bins = bins)
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Vote Share (%)", opacity = 0.7) %>%
addLegend("bottomright", pal = rep20_pal, values = maricopa_2020_rep$votes_pct_2020, title = "Vote Share (%)", opacity = 0.7) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Dem Vote Share (%)",
opacity = 0.7, group = c("Democrats - 2016", "Democrats - 2020")) %>%
addLegend("bottomright", pal = rep20_pal, values = maricopa_2020_rep$votes_pct_2020, title = "Rep Vote Share (%)",
opacity = 0.7, group = c("Republicans - 2016", "Republicans - 2020")) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Dem Vote Share (%)",
opacity = 0.7, group = c("Democrats - 2016", "Democrats - 2020")) %>%
addLegend("bottomright", pal = rep20_pal, values = maricopa_2020_rep$votes_pct_2020, title = "Rep Vote Share (%)",
opacity = 0.7, group = c("Republicans - 2016", "Republicans - 2020")) %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
?addLegend
## setting up map
maricopa_map <- leaflet() %>%
addMapboxTiles(style_id = "streets-v11",
username = "mapbox") %>%
addPolygons(data = maricopa_cd, label = ~CD, group = "Congressional District") %>%
addPolygons(data = maricopa_cd_2016_rep, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Republicans - 2016", fillColor = ~rep20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2016_dem, label = ~paste("CD ", CD, ": ", votes_pct_2016, "%", sep = ""),
group = "Democrats - 2016", fillColor = ~dem20_pal(votes_pct_2016), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_rep, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Republicans - 2020", fillColor = ~rep20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addPolygons(data = maricopa_cd_2020_dem, label = ~paste("CD ", CD, ": ", votes_pct_2020, "%", sep = ""),
group = "Democrats - 2020", fillColor = ~dem20_pal(votes_pct_2020), fillOpacity = 0.75,
weight = 0, opacity = 0, color = "white") %>%
addLegend("bottomright", pal = dem20_pal, values = maricopa_2020_dem$votes_pct_2020, title = "Dem Vote Share (%)",
opacity = 0.7, group = c("Democrats - 2016", "Democrats - 2020")) %>%
addLegend("bottomleft", pal = rep20_pal, values = maricopa_2020_rep$votes_pct_2020, title = "Rep Vote Share (%)",
opacity = 0.7, group = "Republicans - 2016") %>%
addLayersControl(overlayGroups = c("Congressional District", "Republicans - 2016", "Democrats - 2016",
"Republicans - 2020", "Democrats - 2020"),
options = layersControlOptions(collapsed = FALSE)) %>%
hideGroup(c("Republicans - 2016", "Democrats - 2016", "Republicans - 2020", "Democrats - 2020")) %>%
setView(lng = phoenix[1], lat = phoenix[2], zoom = 8.5)
maricopa_map
